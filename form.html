<!DOCTYPE html>
<html>
    <head>
        <title>Mail Content</title>
        <meta charset="utf-8" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />

        <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.1.0/fabric.min.css">
        <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.1.0/fabric.components.min.css">
        <link rel="stylesheet" href="style.css">

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
        <script>
            'use strict';
                Office.onReady(function () {
                    $(document).ready(function () {
                        loadItemProps(Office.context.mailbox.item);
                    });
                });
            
                function loadItemProps(item) {
            
                    $('#item-subject').text(item.subject);
            
                    Office.context.mailbox.item.body.getAsync(
                        "text",
                        { asyncContext: "This is passed to the callback" },
                        function callback(result) {
                            if (result.status === Office.AsyncResultStatus.Succeeded) {
                                var emailBody = result.value;
                                document.getElementById("body").textContent = emailBody;
                            } else {
                                console.error('Errore nel recupero del corpo della email:', result.error.message);
                            }
                        }
                    );
                }
        </script>
    </head>
    <body>
        <div class="ms-Fabric content-main">
            <h1 class="ms-font-xl ms-fontColor-themeDarkAlt ms-fontWeight-bold">Mail Content</h1>
            <h1><strong>Subject</strong></h1>
            <p class="prop-val"><code><label id="item-subject"></label></code></p>
            <h1><strong>Message</strong></h1>
            <p class="prop-val"><code><label id="body"></label></code></p>
        </div>
    </body>
</html>
